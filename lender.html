<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title></title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.4.3/css/bulma.min.css">
  &lt;style media=&quot;screen&quot;&gt;
  p &gt; span { font-weight: bold; }
  &lt;/style&gt;
</head>
<body>
  <section class="hero is-primary is-bold">
    <div class="hero-body">
      <div class="container">
        <h1 class="title">
          SyndiCoin
        </h1>
        <h2 class="subtitle">
          Let's get your loan sorted in few minutes...
        </h2>
      </div>
    </div>
  </section>
  <section class=main>
    <div style="height: 50px;"></div>
    <div class="container">
      &lt;!-- &lt;p&gt;Prerequisites: Metamask installed and set-up&lt;/p&gt;
      &lt;div style=&quot;height: 30px;&quot;&gt;&lt;/div&gt; --&gt;
      <div class="content is-medium steps">
        <h5 class=subtitle>Submit your loan application:</h5>
        <ol>
          <li>
            <button class="button deploy_contract_btn">Deploy Contract</button>
          </li>
          <li>
          <input type="text"  class="input lender_company_name" name="recipient_address" value="" placeholder="Enter your company name" style="width: 300px;"></input>
          </li>
          <li><input type="text"  class="input lender_company_reg_number" name="recipient_address" value="" placeholder="Enter company's registration number" style="width: 300px;">
          </input>
        </li>
        <li><input type="Enter the "  class="input loan_seeked_amount" name="recipient_address" value="" placeholder="0x....." style="width: 300px;">
        </input>
      </li>
      <button class="raise_contract_btn" style="width: 150px; height: 40px;"">Raise Contract</button>
    </li>
  </ol>
  <div style="height: 30px;"></div>

  <h5 class=subtitle>Data:</h5>
  <p>Balance: <span class=balance>...</span> wei</p>
  <p>Deployed contract address: <span class=contract_address>0x...</span></p>
  <p>Token balance: <span class=token_balance>...</span> <span class=token_symbol></span></p>
</div>

<div class="is-small" style="color: grey; margin-top: 200px">
  Disclaimer: Applied Blockchain and Fintech Week&reg; are not endorsing the creation of ICOs and ethereum token sales as there are legal risks associated with it (you will probably face legal charges) - This code sample is made just to explore the technical possibilities of developing applications on top of the Ethereum platform.
</div>

</div>
</section>

&lt;!-- If you don't want to use metamask you can use a local node and web3.js metamask will inject web3 for you so you don't need to do this: &lt;script src=&quot;https://cdn.rawgit.com/ethereum/web3.js/develop/dist/web3.min.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt; --&gt;
&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.5.0/bluebird.min.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;!-- if your browser doesn't supports async/await you may want to use https://github.com/yortus/asyncawait -  --&gt;
&lt;script type=&quot;text/javascript&quot;&gt;

// PLEASE NOTE that the minimum Chrome version to run this code is 55 (async/await)

// Token contract code used for this example: https://gist.github.com/makevoid/ec7f9d94fdeb78d06cea48a17a117213

// Any ERC20 Ethereum Standard Token will be compatible with this script.

var d = document
var c = console
var g = window // global scope shortcut
g.bytecode = null
g.abi = null
g.contractAddress = null
g.tokenContract = null

var main = async function() {
// setup web3
if (typeof web3 !== 'undefined') {
// connect to metamask (preferred)
g.web3 = new Web3(web3.currentProvider)
} else {
// connect to your local geth or parity node instead
g.web3 = new Web3(new Web3.providers.HttpProvider(&quot;http://localhost:8545&quot;))
}
g.eth = g.web3.eth

// setup functions to be called via await (simpler than using callbacks)
var getCoinbase = Promise.promisify(g.eth.getCoinbase)
g.getBalance    = Promise.promisify(g.eth.getBalance)

// get your first ethereum address (coinbase address)
g.coinbase = await getCoinbase()

// token contract class
var TokenContract = g.eth.contract(g.abi)
g.TokenContract   = TokenContract

// token contract instance
if (localStorage.ftw_token_address) {
g.tokenContract = TokenContract.at(localStorage.ftw_token_address)
}

// all actions
bindSendTokensBtn()
bindDeployContract()
loadAddress()
updateBalance()
updateTokenBalance()
}

// calls eth.getBalance (gets balance in weis - &quot;micro&quot; ethers)
var updateBalance = async function() {
var balance = await g.getBalance(g.coinbase)
d.querySelector(&quot;.balance&quot;).innerHTML = balance
}

// calls token.balanceOf (token balance of a specific address)
var updateTokenBalance = async function() {
var balanceOf = Promise.promisify(g.tokenContract.balanceOf)
var symbol    = Promise.promisify(g.tokenContract.symbol)

var balance = await balanceOf(g.coinbase) // in this case the address is your current metamask address (coinbase)
var sym     = await symbol()

var tokenBalance = d.querySelector(&quot;.token_balance&quot;)
var tokenSymbol  = d.querySelector(&quot;.token_symbol&quot;)
tokenBalance.innerHTML = balance
tokenSymbol.innerHTML  = sym
}

var loadAddress = function () {
// loads address from local storage if you have already deployed a token contract address with this browser &quot;user/account&quot;
var address = localStorage.ftw_token_address
if (address) {
g.contractAddress = address
var addressElem = d.querySelector(&quot;.contract_address&quot;)
addressElem.innerHTML = address
g.tokenContract = g.TokenContract.at(localStorage.ftw_token_address)
}
}

// triggers the creation of a token contract
var deployContract = async function() {
g.TokenContract.new([], {
data: g.bytecode,
from: g.coinbase,
gas:  1000000
}, contractDeploymentCallback)
}

// this function will be called twice so it wasn't possible to promisify-it
// the second time you get this callback your token contract will be likely to be deployed already and you will get the address of it
var contractDeploymentCallback = function(err, resp) {
if (err) c.error(err)
var address = resp.address
var addressElem = d.querySelector(&quot;.contract_address&quot;)
addressElem.innerHTML = &quot;Waiting for the transaction to be confirmed.... (can take up to a minute)&quot;

if (address) {
addressElem.innerHTML = address
// we save the address in the local storage so we can point to the same contract after a browser refresh
localStorage.ftw_token_address = address
g.contractAddress = address
}
}

// this is the first time we actually do a sendTransaction call (a standard ethereum transaction)
// here we call the token contract method `transfer`
var sendTokens = async function() {
var recipientElem = d.querySelector(&quot;.recipient_address&quot;)
var recipient = recipientElem.value

var setNumber = Promise.promisify(g.tokenContract.raiseLoadRequest)

var tokenTransferAmount = 100 // FIXME&quot; hardcoded amount, in a real app you probably want to specify the amount transfered

var result = await setNumber(recipient)
c.log(result)
}

var bindSendTokensBtn = function() {
var sendTokensBtn = d.querySelector(&quot;.send_tokens_btn&quot;)
sendTokensBtn.addEventListener(&quot;click&quot;, sendTokens)
}

var bindDeployContract = function() {
var deployBtn = d.querySelector(&quot;.deploy_contract_btn&quot;)
deployBtn.addEventListener(&quot;click&quot;, deployContract)
}


window.addEventListener('load', main)

// long (but important) variables are defined here (contract bytecode and contract ABI):

// bytecode is the contrect compiled in binary format, needed to &quot;deploy&quot; (publish) the contract to the ethereum network
// abi is the application binary interface, it tells your web3.js library which are the function names and its arguments to be able to call them.

// contract bytecode
g.bytecode = &quot;6060604052341561000f57600080fd5b5b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b5b6106c2806100616000396000f30060606040523615610076576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806302d05d3f1461007b5780630cc5bc06146100d057806317ef9b34146100f95780632229f093146101e557806343cfbd6514610274578063efcbb0f014610303575b600080fd5b341561008657600080fd5b61008e610318565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156100db57600080fd5b6100e361033d565b6040518082815260200191505060405180910390f35b341561010457600080fd5b6101e3600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001909190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610348565b005b34156101f057600080fd5b6101f8610451565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102395780820151818401525b60208101905061021d565b50505050905090810190601f1680156102665780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561027f57600080fd5b6102876104fa565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156102c85780820151818401525b6020810190506102ac565b50505050905090810190601f1680156102f55780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561030e57600080fd5b6103166105a3565b005b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600060015490505b90565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415610445576000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141561043f5783600290805190602001906104089291906105dd565b50826003908051906020019061041f9291906105dd565b5081600181905550806004908051906020019061043d9291906105dd565b505b5b61044a565b600080fd5b5b50505050565b61045961065d565b60038054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156104ef5780601f106104c4576101008083540402835291602001916104ef565b820191906000526020600020905b8154815290600101906020018083116104d257829003601f168201915b505050505090505b90565b61050261065d565b60028054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156105985780601f1061056d57610100808354040283529160200191610598565b820191906000526020600020905b81548152906001019060200180831161057b57829003601f168201915b505050505090505b90565b73ca35b7d915458ef540ade6068dfe2f44e8fa733c3373ffffffffffffffffffffffffffffffffffffffff1614156105da57600080fd5b5b565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061061e57805160ff191683800117855561064c565b8280016001018555821561064c579182015b8281111561064b578251825591602001919060010190610630565b5b5090506106599190610671565b5090565b602060405190810160405280600081525090565b61069391905b8082111561068f576000816000905550600101610677565b5090565b905600a165627a7a7230582067ad66df04919b4dd2b4ace3693606b97e1debaf00049644f0b2c97aeaeac4520029&quot;

// contract abi
g.abi = [{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;creator&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;address&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;getLoanAmountNeeded&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;_companyName&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;name&quot;:&quot;_companyRegNumber&quot;,&quot;type&quot;:&quot;string&quot;},{&quot;name&quot;:&quot;_loanAmountNeeded&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;_supportingDocument&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;name&quot;:&quot;raiseLoanRequest&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;getCompanyregnumber&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[],&quot;name&quot;:&quot;getCompanyName&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;}],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:false,&quot;inputs&quot;:[],&quot;name&quot;:&quot;validateUser&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;function&quot;},{&quot;inputs&quot;:[],&quot;payable&quot;:false,&quot;type&quot;:&quot;constructor&quot;}]



// contract was compiled via:  https://ethereum.github.io/browser-solidity/

// feel free to ask questions to @makevoid during Saturday about the JS code above and feel free to change it completely to however you'll like :)
&lt;/script&gt;
</body>
</html>
